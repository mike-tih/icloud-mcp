version: '3.8'

services:
  icloud-mcp:
    build: .
    container_name: icloud-mcp-server
    ports:
      - "${MCP_SERVER_PORT:-8000}:8000"
    environment:
      # iCloud credentials (optional, can use headers instead)
      - ICLOUD_EMAIL=${ICLOUD_EMAIL:-}
      - ICLOUD_APP_SPECIFIC_PASSWORD=${ICLOUD_APP_SPECIFIC_PASSWORD:-}

      # Server configuration (optional, defaults provided)
      - CALDAV_SERVER=${CALDAV_SERVER:-https://caldav.icloud.com}
      - CARDDAV_SERVER=${CARDDAV_SERVER:-https://contacts.icloud.com}
      - IMAP_SERVER=${IMAP_SERVER:-imap.mail.me.com}
      - SMTP_SERVER=${SMTP_SERVER:-smtp.mail.me.com}
      - PORT=8000

    restart: unless-stopped
